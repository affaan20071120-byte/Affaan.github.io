<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Scientific Calculator — Affaan</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --text:#e7e8ee; --muted:#b7bbd0;
    --card: rgba(255,255,255,0.05);
    --line: rgba(255,255,255,0.12);
    --bg1:#0b0f2a; --bg2:#2b0d3a;
    --glow: #ffd166;
  }
  *{ box-sizing:border-box; }
  body{
    margin:0; min-height:100vh; color:var(--text); font-family:Poppins,system-ui,Arial;
    display:flex; align-items:center; justify-content:center; padding:20px;
    background: radial-gradient(1200px 800px at 20% 10%, rgba(255,60,80,0.10), transparent 60%),
                radial-gradient(1000px 700px at 80% 30%, rgba(58,160,255,0.12), transparent 60%),
                linear-gradient(180deg, var(--bg1), var(--bg2));
  }
  .wrap{
    width:min(520px, 96vw);
    background:var(--card); border:1px solid var(--line); border-radius:16px; padding:18px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    backdrop-filter: blur(6px);
  }
  h1{ margin:6px 6px 12px; font-size:clamp(20px, 3.2vw, 28px); }
  p{ color:var(--muted); margin:8px 6px 16px; }
  .display{
    width:100%; border:1px solid var(--line); border-radius:12px; padding:10px 12px; margin-bottom:12px;
    background: rgba(0,0,0,0.3); font-size:22px; text-align:right; word-wrap:break-word; min-height:58px;
    box-shadow: 0 0 20px var(--glow), 0 0 30px rgba(255,255,255,0.1);
    color: #ffd166;
  }
  .grid{ display:grid; grid-template-columns: repeat(5, 1fr); gap:8px; }
  button{
    padding:12px 10px; border-radius:12px; border:1px solid var(--line); background:rgba(0,0,0,0.25);
    color:var(--text); font-weight:600; cursor:pointer;
    box-shadow: 0 0 10px var(--glow), 0 0 14px rgba(255,255,255,0.25);
    transition: transform .12s ease, box-shadow .2s ease;
  }
  button:hover{
    transform: translateY(-2px);
    box-shadow: 0 0 18px var(--glow), 0 0 28px rgba(255,255,255,0.3);
  }
  .wide{ grid-column: span 2; }
  .equals{ grid-column: span 2; }
  .toggle-btn{
    grid-column: span 2;
    background: rgba(255,255,255,0.1);
    color: #ffd166;
    box-shadow: 0 0 20px var(--glow), 0 0 30px rgba(255,255,255,0.2);
  }
</style>
</head>
<body>
<div class="wrap">
  <h1>Scientific Calculator</h1>
  <p>Neon-styled calculator with DEG/RAD toggle & exact trigonometric fractions.</p>
  <div id="display" class="display"></div>
  <div class="grid" id="keys"></div>
</div>

<script>
const display = document.getElementById('display');
const keys = document.getElementById('keys');

const buttons = [
  '7','8','9','(',')',
  '4','5','6','^','√',
  '1','2','3','×','÷',
  '0','.','+','-','=',
  'sin','cos','tan','log','ln',
  'π','e','x²','1/x','%',
  'C','DEL','ANS','EXP','±',
  'DEG' // Added toggle button for DEG/RAD
];

let memoryAns = 0;
let mode = 'deg'; // default mode

function btn(label){
  const b = document.createElement('button');
  b.textContent = label;
  if (label==='=' || label==='C' || label==='DEL') b.classList.add('wide');
  if (label==='=') b.classList.add('equals');
  if(label==='DEG') b.classList.add('toggle-btn');
  b.addEventListener('click', ()=>press(label));
  return b;
}
buttons.forEach(l => keys.appendChild(btn(l)));

function insert(text){ display.textContent += text; }

function press(key){
  if (key === 'C'){ display.textContent=''; return; }
  if (key === 'DEL'){ display.textContent = display.textContent.slice(0,-1); return; }
  if (key === 'ANS'){ insert(memoryAns.toString()); return; }
  if (key === 'π'){ insert('π'); return; }
  if (key === 'e'){ insert('e'); return; }
  if (key === 'x²'){ insert('^2'); return; }
  if (key === '1/x'){ insert('^-1'); return; }
  if (key === 'EXP'){ insert('e^'); return; }
  if (key === '±'){ toggleSign(); return; }
  if (['sin','cos','tan','log','ln','√'].includes(key)){ insert(key + '('); return; }
  if (key === '×'){ insert('*'); return; }
  if (key === '÷'){ insert('/'); return; }
  if (key === '='){ evaluate(); return; }
  if(key==='DEG'){ toggleDegRad(); return; }
  insert(key);
}

function toggleSign(){
  const s = display.textContent;
  const m = s.match(/(-?\d*\.?\d+)(?!.*\d)/);
  if (!m) { insert('-'); return; }
  const start = m.index; const end = start + m[0].length;
  const before = s.slice(0,start);
  const num = m[0];
  const after = s.slice(end);
  const toggled = num.startsWith('-') ? num.slice(1) : '-' + num;
  display.textContent = before + toggled + after;
}

const trigExactValues = {
  'deg': {
    '0':'0','30':'1/2','45':'1/√2','60':'√3/2','90':'1',
    '120':'√3/2','135':'1/√2','150':'1/2','180':'0',
    '210':'-1/2','225':'-1/√2','240':'-√3/2','270':'-1',
    '300':'-√3/2','315':'-1/√2','330':'-1/2','360':'0'
  },
  'rad': {
    '0':'0','π/6':'1/2','π/4':'1/√2','π/3':'√3/2','π/2':'1',
    '2π/3':'√3/2','3π/4':'1/√2','5π/6':'1/2','π':'0',
    '7π/6':'-1/2','5π/4':'-1/√2','4π/3':'-√3/2','3π/2':'-1',
    '5π/3':'-√3/2','7π/4':'-1/√2','11π/6':'-1/2','2π':'0'
  }
};

function toggleDegRad(){
  mode = mode==='deg'?'rad':'deg';
  document.querySelector('.toggle-btn').textContent = mode.toUpperCase();
}

function toJS(expr){
  let js = expr
    .replace(/π/g, 'Math.PI')
    .replace(/e(?=[^a-zA-Z0-9_])/g, 'Math.E')
    .replace(/√\(/g, 'Math.sqrt(')
    .replace(/\^/g, '**');

  ['sin','cos','tan','log','ln'].forEach(fn=>{
    js = js.replace(new RegExp(fn+'\\(','g', fn+'(');
  });
  return js;
}

function evaluate(){
  try{
    let text = display.textContent;

    // Detect single trig functions to use exact values
    const trigMatch = text.match(/(sin|cos|tan)\(([^)]+)\)/);
    if(trigMatch){
      let fn = trigMatch[1];
      let val = trigMatch[2].trim();
      let exact = trigExactValues[mode][val];
      if(exact){
        display.textContent = exact;
        memoryAns = exact;
        return;
      }
    }

    const js = toJS(text);
    const val = Function('return (' + js + ')')();
    display.textContent = val;
    memoryAns = val;
  }catch(e){
    display.textContent = 'Error';
  }
}

document.addEventListener('keydown', (e)=>{
  const k = e.key;
  if ((k>='0' && k<='9') || k==='.' || k==='+' || k==='-' || k==='*' || k==='/'
      || k==='(' || k===')' || k==='%' ){
    insert(k);
  } else if (k==='Backspace'){ press('DEL'); }
  else if (k==='Enter'){ evaluate(); }
});
</script>
</body>
</html>
